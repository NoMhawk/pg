<!DOCTYPE html>
<html>

<head>
    <!-- JavaScript Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-gtEjrD/SeCtmISkJkNUaaKMoLD0//ElJ19smozuHV6z3Iehds+3Ulb9Bn9Plx0x4"
        crossorigin="anonymous"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-+0n0xVW2eSR5OomGNYDnhzAbDsOXxcvSN1TPprVMTNDbiYZCxYbOOl7+AMvyTG2x" crossorigin="anonymous">
    <meta charset="utf-8">
    <title>Paragliding Wind xRose</title>
    <style>
        body {
            font: 12px sans-serif;
            text-align: center;
        }

        svg {
            margin: 0px auto;
            display: block;
        }

        path.arc {
            opacity: 0.9;
            transition: opacity 0.5s;
        }

        path.arc:hover {
            opacity: 0.7;
        }

        .axis line,
        .axis circle {
            stroke: #cccccc;
            stroke-width: 1px
        }

        .axis circle {
            fill: none;
        }

        .r.axis text {
            text-anchor: end
        }

        .tooltip {
            position: absolute;
            display: none;
            background: rgba(0, 0, 0, 0.6);
            border-radius: 3px;
            box-shadow: -3px 3px 15px #888;
            color: white;
            padding: 6px;
        }

        .colorBox {
            float: left;
            width: 15px;
            height: 15px;
            margin: 5px;
            border: 1px solid rgba(0, 0, 0, .2);
        }
    </style>
    <script src="https://d3js.org/d3.v4.min.js"></script>
</head>

<body>

    <div class="container mt-2" align="center">
        <div class="row">
            <div class="col-lg-4">
                <div class="card mt-2" style="width: 18rem;">
                    <h6 class="mt-2">Wind Rose</h5>
                        <div class="card-body" style="text-align: left;">
                            <label for="clubSelector">Club</label>
                            <select class="form-select" id="clubSelector">
                                <option>Wessex</option>
                                <option>Avon</option>
                                <option>Condors</option>
                                <option>Sky Surfers</option>
                                <option>North Devon</option>
                                <option>Thames Valley</option>
                                <option>SE Wales</option>
                            </select>
                        </div>
                </div>
            </div>


    <script>
        const width = 960,
            height = 800,
            chartRadius = height / 2 - 40,
            levels =8,
            maxValue = 100,
            angleSlice = ((45 / 2) * Math.PI / 180), //2 if allaxis2
            labelFactor = 1.12,
            wrapWidth = 60,
            margin = 40,
            allAxis = ['N', 'NE', 'E', 'SE', 'S', 'SW', 'W', 'NW'];
        allAxis2 = ['N', 'NNE', 'NE', 'ENE', 'E', 'ESE', 'SE', 'SSE', 'S', 'SSW', 'SW', 'WSW', 'W', 'WNW', 'NW', 'NNW'];

        const color = d3.scaleOrdinal(d3.schemeCategory10);

        //Scale for the radius
        var rScale = d3.scaleLinear()
            .range([0, chartRadius])
            .domain([0, maxValue]);

        /////DATA
        var membershipColors = {
            'Members': 'red',
            'Open': 'green',
            'Reciprocal': 'blue',
        }

        var ratingColors = {
            'Pilot': 'khaki',
            'Pilotplus50': 'PeachPuff',
            'Pilotplus100': 'PapayaWhip',
            'CPplus25': 'yellow',
            'CPplus10': 'aquamarine',
            'CP': 'lightblue',
            'CPM': 'lime',
        }

        var data = [
            {
                site: 'Bell Hill',
                club: 'Wessex',
                start: 275,
                end: 340,
                siteGuideUrl: 'http://wessexhgpg.org.uk/Sites/SiteGuide/BellHill.pdf',
                pgRating: 'CP',
                hgRating: 'CP',
                membership: 'Open',
                lat: 50.875833, 
                lon: -2.288333,
                level: 7
            },
            {
                site: 'Winklebury',
                club: 'Wessex',
                start: 275,
                end: 340,
                siteGuideUrl: 'http://wessexhgpg.org.uk/Sites/SiteGuide/Winklebury.pdf',
                pgRating: 'CP',
                hgRating: 'CP',
                membership: 'Open',
                level: 5
            },
            {
                site: 'Whitesht',
                club: 'Wessex',
                start: 260,
                end: 280,
                siteGuideUrl: 'http://wessexhgpg.org.uk/Sites/SiteGuide/WhiteSheet.pdf',
                pgRating: 'CP',
                hgRating: 'CPplus10',
                membership: 'Open',
                level: 6
            },
            {
                site: 'Portland West',
                club: 'Wessex',
                start: 270,
                end: 315,
                siteGuideUrl: 'http://wessexhgpg.org.uk/Sites/SiteGuide/PortlandWest.pdf',
                pgRating: 'Pilot',
                hgRating: 'Unsuitable',
                membership: 'Open',
                level: 4,
            },
            {
                site: 'Portland East',
                club: 'Wessex',
                start: 60,
                end: 120,
                siteGuideUrl: 'http://wessexhgpg.org.uk/Sites/SiteGuide/PortlandEast.pdf',
                pgRating: 'Pilot',
                hgRating: 'Unsuitable',
                membership: 'Open',
                level: 4,
            },
            {
                site: 'Ringstead',
                club: 'Wessex',
                start: 210,
                end: 260,
                siteGuideUrl: 'http://wessexhgpg.org.uk/Sites/SiteGuide/RingsteadBay.pdf',
                pgRating: 'CPplus10',
                hgRating: 'Advanced Pilot',
                membership: 'Open',
                level: 6,
            },
            {
                site: 'Monks Down',
                club: 'Wessex',
                start: 340,
                end: 390,
                siteGuideUrl: 'http://wessexhgpg.org.uk/Sites/SiteGuide/Monksdown.pdf',
                pgRating: 'CP',
                hgRating: 'CP',
                membership: 'Members',
                level: 6,
            },
            {
                site: 'Ninebarrow Down',
                club: 'Wessex',
                start: 0,
                end: 45,
                siteGuideUrl: 'http://wessexhgpg.org.uk/Sites/SiteGuide/Nine%20Barrow%20Down.pdf',
                pgRating: 'CP',
                hgRating: 'Unsuitable',
                membership: 'Members',
                level: 7,
            },
            {
                site: 'Cowdown',
                club: 'Wessex',
                start: 250,
                end: 290,
                siteGuideUrl: 'http://www.wessexhgpg.org.uk/Sites/Siteguide/CowDown.pdf',
                pgRating: 'Pilotplus100',
                hgRating: 'Unsuitable',
                membership: 'Members',
                level: 3,
            },
            {
                site: 'Bulbarrow',
                club: 'Wessex',
                start: 202.5,
                end: 247.5,
                siteGuideUrl: 'http://www.wessexhgpg.org.uk/Sites/Siteguide/Bulbarrow.pdf',
                pgRating: 'CPplus10',
                hgRating: 'CPplus10',
                membership: 'Open',
                level: 2,
            },
            {
                site: 'Swallowcliff',
                club: 'Wessex',
                start: 290,
                end: 335,
                siteGuideUrl: 'http://wessexhgpg.org.uk/Sites/SiteGuide/Swallowcliffe.pdf',
                pgRating: 'CP',
                hgRating: 'Unsuitable',
                membership: 'Members',
                level: 6,
            },
            {
                site: 'Maiden Castle',
                club: 'Wessex',
                start: 330,
                end: 390,
                siteGuideUrl: 'http://wessexhgpg.org.uk/Sites/SiteGuide/MaidenCastle.pdf',
                pgRating: 'CP',
                hgRating: 'Unsuitable',
                membership: 'Open',
                level: 5,
            },
            {
                site: 'Okeford',
                club: 'Wessex',
                start: 5,
                end: 40,
                siteGuideUrl: 'http://wessexhgpg.org.uk/Sites/SiteGuide/OkefordHill.pdf',
                pgRating: 'CPplus10',
                hgRating: 'CPplus10',
                membership: 'Open',
                level: 4,
            },
            {
                site: 'Corton Denham',
                club: 'Wessex',
                start: 210,
                end: 280,
                siteGuideUrl: 'http://wessexhgpg.org.uk/Sites/SiteGuide/CortonDenham.pdf',
                pgRating: 'CP',
                hgRating: 'CP',
                membership: 'Open',
                level: 8,
            },
            {
                site: 'Ballard Down',
                club: 'Wessex',
                start: 140,
                end: 185,
                siteGuideUrl: 'http://wessexhgpg.org.uk/Sites/SiteGuide/BallardDown.pdf',
                pgRating: 'CPplus10',
                hgRating: 'CPplus10',
                membership: 'Open',
                level: 6,
            },
            {
                site: 'White Horse',
                club: 'Wessex',
                start: 180,
                end: 220,
                siteGuideUrl: 'http://wessexhgpg.org.uk/Sites/SiteGuide/WhiteHorse.pdf',
                pgRating: 'CP',
                hgRating: 'CP',
                membership: 'Open',
                level: 5,
            },
            {
                site: 'Southbourne',
                club: 'Wessex',
                start: 160,
                end: 200,
                siteGuideUrl: 'http://wessexhgpg.org.uk/Sites/SiteGuide/SouthBourne.pdf',
                pgRating: 'Pilot',
                hgRating: 'Unsuitable',
                membership: 'Members',
                level: 7,
            },
            {
                site: 'Marleycombe',
                club: 'Wessex',
                start: 315,
                end: 360,
                siteGuideUrl: 'http://wessexhgpg.org.uk/Sites/SiteGuide/Marleycombe.pdf',
                pgRating: 'CP',
                hgRating: 'CPplus10',
                membership: 'Open',
                level: 4,
            },
            {
                site: 'Friar Waddon',
                club: 'Wessex',
                start: 160,
                end: 200,
                siteGuideUrl: 'http://wessexhgpg.org.uk/Sites/SiteGuide/FriarWaddon.pdf',
                pgRating: 'CP',
                hgRating: 'Unsuitable',
                membership: 'Open',
                level: 8,
            },
            {
                site: 'Knitson',
                club: 'Wessex',
                start: 180,
                end: 230,
                siteGuideUrl: 'http://wessexhgpg.org.uk/Sites/SiteGuide/Knitson.pdf',
                pgRating: 'CP',
                hgRating: 'CPplus10',
                membership: 'Open',
                level: 4,
            },
            {
                site: 'Kimmeridge',
                club: 'Wessex',
                start: 210,
                end: 270,
                siteGuideUrl: 'http://wessexhgpg.org.uk/Sites/SiteGuide/Kimmeridge.pdf',
                pgRating: 'CP',
                hgRating: 'CP',
                membership: 'Open',
                level: 7,
            },
            {
                site: 'St Aldhelms',
                club: 'Wessex',
                start: 225,
                end: 270,
                siteGuideUrl: 'http://www.wessexhgpg.org.uk/Sites/Siteguide/StAldhelms.pdf',
                pgRating: 'Pilot',
                hgRating: 'Unsuitable',
                membership: 'Open',
                level: 5,
            },

            {
                site: 'Barton on Sea',
                club: 'Wessex',
                start: 135,
                end: 225,
                siteGuideUrl: 'http://wessexhgpg.org.uk/Sites/SiteGuide/Barton.pdf',
                pgRating: 'CPplus25',
                hgRating: 'Unsuitable',
                membership: 'Members',
                level: 3,
            },
            {
                site: 'Hambledon',
                club: 'Wessex',
                start: 22,
                end: 68,
                siteGuideUrl: 'http://wessexhgpg.org.uk/Sites/SiteGuide/Hambledon_Hill.pdf',
                pgRating: 'Pilot',
                hgRating: 'Unsuitable',
                membership: 'Members',
                level: 3,
            },


            {
                site: 'Westbury White Horse',
                club: 'Avon',
                start: 275,
                end: 380,
                siteGuideUrl: "http://avonhgpg.co.uk/sites/sites.php?actionid=2&id=14",
                pgRating: 'CP',
                hgRating: 'Unsuitable',
                membership: 'Open',
                level: 8,
            }
            ,
            {
                site: 'Selsley',
                club: 'Avon',
                start: 292.5,
                end: 337.5,
                siteGuideUrl: 'http://avonhgpg.co.uk/sites/sites.php?actionid=2&id=11',
                pgRating: 'CP',
                hgRating: 'CP',
                membership: 'Open',
                level: 7,
            },
            {
                site: 'Cam Long Down',
                club: 'Avon',
                start: 270,
                end: 360,
                siteGuideUrl: '',
                pgRating: 'CP',
                hgRating: 'CP',
                membership: 'Open',
                level: 6,
            },
            {
                site: 'Frocester',
                club: 'Avon',
                start: 270,
                end: 315,
                siteGuideUrl: 'http://avonhgpg.co.uk/sites/sites.php?actionid=2&id=6',
                pgRating: 'Pilot',
                hgRating: 'Unsuitable',
                membership: 'Open',
                level: 5,
            },
            {
                site: 'Morgans',
                club: 'Avon',
                start: 280,
                end: 350,
                siteGuideUrl: 'http://avonhgpg.co.uk/sites/sites.php?actionid=2&id=9',
                pgRating: 'Pilot',
                hgRating: 'Pilot',
                membership: 'Members',
                level: 4,
            },
            {
                site: 'Draycott',
                club: 'Avon',
                start: 200,
                end: 230,
                siteGuideUrl: 'http://avonhgpg.co.uk/sites/sites.php?actionid=2&id=5',
                pgRating: 'Pilot',
                hgRating: 'Pilot',
                membership: 'Members',
                level: 8,
            },
            {
                site: 'Crook Peak',
                club: 'Avon',
                start: 180,
                end: 247.5,
                siteGuideUrl: 'http://avonhgpg.co.uk/sites/sites.php?actionid=2&id=4',
                pgRating: 'Pilot',
                hgRating: 'Pilot',
                membership: 'Open',
                level: 7,
            },
            {
                site: 'Mere Rifle Range',
                club: 'Avon',
                start: 112.5,
                end: 202.5,
                siteGuideUrl: 'http://avonhgpg.co.uk/sites/sites.php?actionid=2&id=10',
                pgRating: 'CP',
                hgRating: 'CP',
                membership: 'Open',
                level: 6,
            },
            {
                site: 'Long Knoll',
                club: 'Avon',
                start: 157.5,
                end: 202.5,
                siteGuideUrl: 'http://avonhgpg.co.uk/sites/sites.php?actionid=2&id=7',
                pgRating: 'CP',
                hgRating: 'CP',
                membership: 'Open',
                level: 5,
            },
            {
                site: 'Coward',
                club: 'Avon',
                start: 202.5,
                end: 247.5,
                siteGuideUrl: 'http://avonhgpg.co.uk/sites/sites.php?actionid=2&id=3',
                pgRating: 'CP',
                hgRating: 'CP',
                membership: 'Open',
                level: 5,
            },
            {
                site: 'Spencers',
                club: 'Avon',
                start: 190,
                end: 260,
                siteGuideUrl: 'http://avonhgpg.co.uk/sites/sites.php?actionid=2&id=12',
                pgRating: 'Pilot',
                hgRating: 'Pilot',
                membership: 'Members',
                level: 4,
            },
            {
                site: 'Ubley',
                club: 'Avon',
                start: 0,
                end: 45,
                siteGuideUrl: 'http://www.avonhgpg.co.uk/sites/sites.php?id=13',
                pgRating: 'Pilot',
                hgRating: 'Pilot',
                membership: 'Open',
                level: 4,
            },
            {
                site: 'Maes Knoll',
                club: 'Avon',
                start: 90,
                end: 135,
                siteGuideUrl: 'http://avonhgpg.co.uk/sites/sites.php?actionid=2&id=8',
                pgRating: 'CP',
                hgRating: 'CP',
                membership: 'Open',
                level: 8,
            },
            {
                site: 'Beer Head',
                club: 'Condors',
                start: 170,
                end: 202.5,
                siteGuideUrl: 'https://www.dscondors.co.uk/node/136',
                pgRating: 'CP',
                hgRating: 'CP',
                membership: 'Open',
                level: 4,
            },
            {
                site: 'Batcombe',
                club: 'Condors',
                start: 292.5,
                end: 337.5,
                siteGuideUrl: 'https://www.dscondors.co.uk/node/134',
                pgRating: 'CP',
                hgRating: 'CP',
                membership: 'Members',
                level: 4,
            },
            {
                site: 'Bickleigh',
                club: 'Condors',
                start: 22.5,
                end: 67.5,
                siteGuideUrl: 'https://www.dscondors.co.uk/node/449',
                pgRating: 'CP',
                hgRating: 'CP',
                membership: 'Members',
                level: 4,
            },
            {
                site: 'Bossington',
                club: 'Condors',
                start: 270,
                end: 337.5,
                siteGuideUrl: 'https://www.dscondors.co.uk/node/138',
                pgRating: 'CP',
                hgRating: 'CP',
                membership: 'Open',
                level: 5,
            },
            {
                site: 'Branscombe',
                club: 'Condors',
                start: 157.5,
                end: 202.5,
                siteGuideUrl: 'https://www.dscondors.co.uk/node/270',
                pgRating: 'CP',
                hgRating: 'CP',
                membership: 'Members',
                level: 5,
            },
            {
                site: 'Bucknole',
                club: 'Condors',
                start: 112.5,
                end: 157.5,
                siteGuideUrl: 'https://www.dscondors.co.uk/node/273',
                pgRating: 'CP',
                hgRating: 'CP',
                membership: 'Members',
                level: 4,
            },
            {
                site: 'Charmouth',
                club: 'Condors',
                start: 180,
                end: 225,
                siteGuideUrl: 'https://www.dscondors.co.uk/node/276',
                pgRating: 'Pilot',
                hgRating: 'Pilot',
                membership: 'Members',
                level: 6,
            },
            {
                site: 'Coneys',
                club: 'Condors',
                start: 67.5,
                end: 90,
                siteGuideUrl: 'https://www.dscondors.co.uk/node/278',
                pgRating: 'Pilot',
                hgRating: 'Pilot',
                membership: 'Members',
                level: 5,
            },
            {
                site: 'Countisbury',
                club: 'Condors',
                start: 292.5,
                end: 360,
                siteGuideUrl: 'https://www.dscondors.co.uk/node/238',
                pgRating: 'Pilot',
                hgRating: 'Pilot',
                membership: 'Open',
                level: 7,
            },
            {
                site: 'East Hill',
                club: 'Condors',
                start: 270,
                end: 315,
                siteGuideUrl: 'https://www.dscondors.co.uk/node/239',
                pgRating: 'CP',
                hgRating: 'CP',
                membership: 'Open',
                level: 6,
            },
            {
                site: 'Eype',
                club: 'Condors',
                start: 202.5,
                end: 247.5,
                siteGuideUrl: 'https://www.dscondors.co.uk/node/240',
                pgRating: 'CP',
                hgRating: 'CP',
                membership: 'Open',
                level: 4,
            },
            {
                site: 'Farway',
                club: 'Condors',
                start: 0,
                end: 45,
                siteGuideUrl: 'https://www.dscondors.co.uk/node/281',
                pgRating: 'CP',
                hgRating: 'CP',
                membership: 'Members',
                level: 5,
            },
            {
                site: 'North Hill',
                club: 'Condors',
                start: 345,
                end: 405,
                siteGuideUrl: 'https://www.dscondors.co.uk/node/241',
                pgRating: 'CP',
                hgRating: 'CP',
                membership: 'Open',
                level: 8,
            },
            {
                site: 'Porlock',
                club: 'Condors',
                start: 360,
                end: 427.5,
                siteGuideUrl: 'https://www.dscondors.co.uk/node/242',
                pgRating: 'CP',
                hgRating: 'CP',
                membership: 'Open',
                level: 3,
            },
            {
                site: 'Sandy',
                club: 'Condors',
                start: 135,
                end: 157.5,
                siteGuideUrl: 'https://www.dscondors.co.uk/node/277',
                pgRating: 'Pilot',
                hgRating: 'Pilot',
                membership: 'Open',
                level: 5,
            },
            {
                site: 'Selworthy',
                club: 'Condors',
                start: 0,
                end: 22.5,
                siteGuideUrl: 'https://www.dscondors.co.uk/node/259',
                pgRating: 'CP',
                hgRating: 'CP',
                membership: 'Open',
                level: 6,
            },            
            {
                site: 'Butser N-NE',
                club: 'Sky Surfers',
                start: 340,
                end: 415,
                siteGuideUrl: 'https://skysurfingclub.co.uk/site_guide/butser-north/',
                pgRating: 'CPplus10',
                hgRating: 'CPplus10',
                membership: 'Open',
                level: 4,
            },            
            {
                site: 'Butser S',
                club: 'Sky Surfers',
                start: 200,
                end: 225,
                siteGuideUrl: 'https://skysurfingclub.co.uk/site_guide/butser-south/',
                pgRating: 'CP',
                hgRating: 'CP',
                membership: 'Open',
                level: 5,
            },            
            {
                site: 'Butser W',
                club: 'Sky Surfers',
                start: 265,
                end: 325,
                siteGuideUrl: 'https://skysurfingclub.co.uk/site_guide/butser-west/',
                pgRating: 'CP',
                hgRating: 'CP',
                membership: 'Open',
                level: 4,
            },            
            {
                site: 'Chalton',
                club: 'Sky Surfers',
                start: 20,
                end: 100,
                siteGuideUrl: 'https://skysurfingclub.co.uk/site_guide/chalton/',
                pgRating: 'CP',
                hgRating: 'CP',
                membership: 'Open',
                level: 3,
            },            
            {
                site: 'Harting',
                club: 'Sky Surfers',
                start: 340,
                end: 400,
                siteGuideUrl: 'https://skysurfingclub.co.uk/site_guide/harting-down/',
                pgRating: 'CPplus10',
                hgRating: 'CPplus10',
                membership: 'Members',
                level: 5,
            },            
            {
                site: 'Matterly',
                club: 'Sky Surfers',
                start: 350,
                end: 380,
                siteGuideUrl: 'https://skysurfingclub.co.uk/site_guide/matterley-bowl/',
                pgRating: 'Pilot',
                hgRating: 'Pilot',
                membership: 'Open',
                level: 7,
            },            
            {
                site: 'Mercury',
                club: 'Sky Surfers',
                start: 45,
                end: 100,
                siteGuideUrl: 'https://skysurfingclub.co.uk/site_guide/mercury/',
                pgRating: 'CP',
                hgRating: 'CP',
                membership: 'Open',
                level: 7,
            },            
            {
                site: 'Meon Shore',
                club: 'Sky Surfers',
                start: 205,
                end: 240,
                siteGuideUrl: 'https://skysurfingclub.co.uk/site_guide/meon-shore/',
                pgRating: 'CPplus25',
                hgRating: 'CPplus25',
                membership: 'Members',
                level: 6,
            },            
            {
                site: 'Whitewool',
                club: 'Sky Surfers',
                start: 20,
                end: 100,
                siteGuideUrl: 'https://skysurfingclub.co.uk/site_guide/Whitewool/',
                pgRating: 'CP',
                hgRating: 'CP',
                membership: 'Open',
                level: 6,
            },
            {
                site: 'Codden Hill',
                club: 'North Devon',
                start: 0,
                end: 45,
                siteGuideUrl: 'https://ndhpc.co.uk/sites_guide/codden-hill',
                pgRating: 'Pilot',
                hgRating: 'Pilot',
                membership: 'Members',
                level: 6,
            },
            {
                site: 'Cornboruough',
                club: 'North Devon',
                start: 295,
                end: 360,
                siteGuideUrl: 'https://ndhpc.co.uk/sites_guide/cornborough',
                pgRating: 'Pilotplus50',
                hgRating: 'Pilotplus50',
                membership: 'Members',
                level: 5,
            },
            {
                site: 'Trentishoe',
                club: 'North Devon',
                start: 315,
                end: 360,
                siteGuideUrl: 'https://ndhpc.co.uk/sites_guide/trentishoe-fields',
                pgRating: 'Pilotplus100',
                hgRating: 'Pilotplus100',
                membership: 'Members',
                level: 4,
            },
            {
                site: 'Putsborough',
                club: 'North Devon',
                start: 335,
                end: 385,
                siteGuideUrl: 'https://ndhpc.co.uk/sites_guide/putsborough',
                pgRating: 'CPplus10',
                hgRating: 'CPplus10',
                membership: 'Members',
                level: 7,
            },
            {
                site: 'Woolacombe',
                club: 'North Devon',
                start: 245,
                end: 340,
                siteGuideUrl: 'https://ndhpc.co.uk/sites_guide/woolacombe',
                pgRating: 'CP',
                hgRating: 'CP',
                membership: 'Members',
                level: 6,
            },
            {
                site: 'Milk Hill',
                club: 'Thames Valley',
                start: 180,
                end: 270,
                siteGuideUrl: 'https://www.tvhgc.co.uk/milk-hill',
                pgRating: 'CP',
                hgRating: 'CP',
                membership: 'Members',
                level: 4,
            },
            {
                site: 'Milk Hill White Horse',
                club: 'Thames Valley',
                start: 135,
                end: 270,
                siteGuideUrl: 'https://www.tvhgc.co.uk/milk-hill-white-horse',
                pgRating: 'CP',
                hgRating: 'CP',
                membership: 'Members',
                level: 5,
            },
            {
                site: 'Tan Hill',
                club: 'Thames Valley',
                start: 90,
                end: 180,
                siteGuideUrl: 'https://www.tvhgc.co.uk/tan-hill',
                pgRating: 'CP',
                hgRating: 'CP',
                membership: 'Members',
                level: 3,
            },
            {
                site: 'Rybury',
                club: 'Thames Valley',
                start: 202.5,
                end: 315,
                siteGuideUrl: 'https://www.tvhgc.co.uk/rybury',
                pgRating: 'CPplus25',
                hgRating: 'CPplus25',
                membership: 'Members',
                level: 3,
            },
            {
                site: 'Golden Ball',
                club: 'Thames Valley',
                start: 112.5,
                end: 225,
                siteGuideUrl: 'https://www.tvhgc.co.uk/golden-ball',
                pgRating: 'Pilotplus100',
                hgRating: 'Pliotplus100',
                membership: 'Members',
                level: 6,
            },
            {
                site: 'Combe Gibbet',
                club: 'Thames Valley',
                start: 292.5,
                end: 382.5,
                siteGuideUrl: 'https://www.tvhgc.co.uk/combe-gibbet',
                pgRating: 'CP',
                hgRating: 'CP',
                membership: 'Members',
                level: 4,
            },
            {
                site: 'Liddington',
                club: 'Thames Valley',
                start: 292.5,
                end: 337.5,
                siteGuideUrl: 'https://www.tvhgc.co.uk/liddington',
                pgRating: 'CP',
                hgRating: 'CP',
                membership: 'Members',
                level: 5,
            },
            {
                site: 'Uffington',
                club: 'Thames Valley',
                start: 292.5,
                end: 405,
                siteGuideUrl: 'https://www.tvhgc.co.uk/uffington-white-horse',
                pgRating: 'Pilot',
                hgRating: 'Pilot',
                membership: 'Members',
                level: 6,
            },
            {
                site: 'White Hill',
                club: 'Thames Valley',
                start: 292.5,
                end: 337.5,
                siteGuideUrl: 'https://www.tvhgc.co.uk/white-hill',
                pgRating: 'Pilot',
                hgRating: 'Pilot',
                membership: 'Members',
                level: 7,
            },
            {
                site: 'Abertysswg',
                club: 'SE Wales',
                start: 270,
                end: 315,
                siteGuideUrl: 'https://www.flysouthwales.co.uk/site-guides/abertysswg/',
                pgRating: 'CP',
                hgRating: 'CP',
                membership: 'Open',
                level: 8,
            },
            {
                site: 'Garway',
                club: 'SE Wales',
                start: 270,
                end: 315,
                siteGuideUrl: 'https://www.flysouthwales.co.uk/site-guides/garway/',
                pgRating: 'Pilot',
                hgRating: 'Pilot',
                membership: 'Members',
                level: 7,
            },
            {
                site: 'Garway',
                club: 'SE Wales',
                start: 213.75,
                end: 236.25,
                siteGuideUrl: 'https://www.flysouthwales.co.uk/site-guides/garway/',
                pgRating: 'Pilot',
                hgRating: 'Pilot',
                membership: 'Members',
                level: 7,
            },
            {
                site: 'Merthyr',
                club: 'SE Wales',
                start: 247.5,
                end: 292.5,
                siteGuideUrl: 'https://www.flysouthwales.co.uk/site-guides/merthyr/',
                pgRating: 'CP',
                hgRating: 'CP',
                membership: 'Open',
                level: 6,
            },
            {
                site: 'Fochriw',
                club: 'SE Wales',
                start: 247.5,
                end: 315,
                siteGuideUrl: 'https://www.flysouthwales.co.uk/site-guides/fochriw/',
                pgRating: 'CP',
                hgRating: 'CP',
                membership: 'Members',
                level: 5,
            },
            {
                site: 'Skirrid',
                club: 'SE Wales',
                start: 270,
                end: 315,
                siteGuideUrl: 'https://www.flysouthwales.co.uk/site-guides/skirrid/',
                pgRating: 'CP',
                hgRating: 'CP',
                membership: 'Members',
                level: 4,
            },
            {
                site: 'Skirrid',
                club: 'SE Wales',
                start: 90,
                end: 135,
                siteGuideUrl: 'https://www.flysouthwales.co.uk/site-guides/skirrid/',
                pgRating: 'CP',
                hgRating: 'CP',
                membership: 'Members',
                level: 4,
            },
            {
                site: 'Pen Cerrig Calch (Magic)',
                club: 'SE Wales',
                start: 157.5,
                end: 247.5,
                siteGuideUrl: 'https://www.flysouthwales.co.uk/site-guides/pen-cerrig-calch/',
                pgRating: 'Pilot',
                hgRating: 'Pilot',
                membership: 'Members',
                level: 6,
            },
            {
                site: 'Nant-y-Moel',
                club: 'SE Wales',
                start: 202.5,
                end: 247.5,
                siteGuideUrl: 'https://www.flysouthwales.co.uk/site-guides/nant-y-moel/',
                pgRating: 'CP',
                hgRating: 'CP',
                membership: 'Members',
                level: 5,
            },
            {
                site: 'Mynydd Meio',
                club: 'SE Wales',
                start: 202.5,
                end: 247.5,
                siteGuideUrl: 'https://www.flysouthwales.co.uk/site-guides/mynydd-meio/',
                pgRating: 'CP',
                hgRating: 'CP',
                membership: 'Open',
                level: 4,
            },
            {
                site: 'Sugar Loaf',
                club: 'SE Wales',
                start: 157.5,
                end: 202.5,
                siteGuideUrl: 'https://www.flysouthwales.co.uk/site-guides/mynydd-meio/',
                pgRating: 'Pilot',
                hgRating: 'Pilot',
                membership: 'Members',
                level: 4,
            },
            {
                site: 'Blorenge',
                club: 'SE Wales',
                start: 292.5,
                end: 495,
                siteGuideUrl: 'https://www.flysouthwales.co.uk/site-guides/blorenge/',
                pgRating: 'CP',
                hgRating: 'CP',
                membership: 'Open',
                level: 2,
            },
            {
                site: 'Talybont',
                club: 'SE Wales',
                start: 67.5,
                end: 225,
                siteGuideUrl: 'https://www.flysouthwales.co.uk/site-guides/talybont/',
                pgRating: 'CP',
                hgRating: 'CP',
                membership: 'Open',
                level: 3,
            },
            {
                site: 'Hay Bluff',
                club: 'SE Wales',
                start: 22.5,
                end: 67.5,
                siteGuideUrl: 'https://www.flysouthwales.co.uk/site-guides/hay-bluff/',
                pgRating: 'CP',
                hgRating: 'CP',
                membership: 'Members',
                level: 3,
            },
            {
                site: 'Hay Bluff',
                club: 'SE Wales',
                start: 292.5,
                end: 337.5,
                siteGuideUrl: 'https://www.flysouthwales.co.uk/site-guides/hay-bluff/',
                pgRating: 'CP',
                hgRating: 'CP',
                membership: 'Members',
                level: 3,
            },
            {
                site: 'Blaenavon',
                club: 'SE Wales',
                start: 22.5,
                end: 67.5,
                siteGuideUrl: 'https://www.flysouthwales.co.uk/site-guides/Blaenavon/',
                pgRating: 'CP',
                hgRating: 'CP',
                membership: 'Members',
                level: 4,
            },
            {
                site: 'Pontlottyn',
                club: 'SE Wales',
                start: 22.5,
                end: 67.5,
                siteGuideUrl: 'https://www.flysouthwales.co.uk/site-guides/Pontlottyn/',
                pgRating: 'CP',
                hgRating: 'CP',
                membership: 'Open',
                level: 6,
            },
            {
                site: 'Mynnydd Machen',
                club: 'SE Wales',
                start: 22.5,
                end: 67.5,
                siteGuideUrl: 'https://www.flysouthwales.co.uk/site-guides/machen/',
                pgRating: 'Pilot',
                hgRating: 'Pilot',
                membership: 'Members',
                level: 7,
            },
            {
                site: 'Mynnydd Machen',
                club: 'SE Wales',
                start: 135,
                end: 180,
                siteGuideUrl: 'https://www.flysouthwales.co.uk/site-guides/machen/',
                pgRating: 'Pilot',
                hgRating: 'Pilot',
                membership: 'Members',
                level: 7,
            },
            {
                site: 'Cwmparc',
                club: 'SE Wales',
                start: 22.5,
                end: 67.5,
                siteGuideUrl: 'https://www.flysouthwales.co.uk/site-guides/cwmparc/',
                pgRating: 'Pilot',
                hgRating: 'Pilot',
                membership: 'Open',
                level: 8,
            },
            {
                site: 'Rhigos',
                club: 'SE Wales',
                start: 315,
                end: 405,
                siteGuideUrl: 'https://www.flysouthwales.co.uk/site-guides/rhigos/',
                pgRating: 'Pilot',
                hgRating: 'Pilot',
                membership: 'Open',
                level: 5,
            },
            {
                site: 'Pandy',
                club: 'SE Wales',
                start: 45,
                end: 112.5,
                siteGuideUrl: 'https://www.flysouthwales.co.uk/site-guides/pandy/',
                pgRating: 'CP',
                hgRating: 'CP',
                membership: 'Members',
                level: 5,
            },
            {
                site: 'Cwmbran',
                club: 'SE Wales',
                start: 112.5,
                end: 180,
                siteGuideUrl: 'https://www.flysouthwales.co.uk/site-guides/cwmbran/',
                pgRating: 'Pilot',
                hgRating: 'Pilot',
                membership: 'Members',
                level: 5,
            },
            {
                site: 'Garth Hill',
                club: 'SE Wales',
                start: 67.5,
                end: 157.5,
                siteGuideUrl: 'https://www.flysouthwales.co.uk/site-guides/garth-hill/',
                pgRating: 'CP',
                hgRating: 'CP',
                membership: 'Open',
                level: 6,
            },
            {
                site: 'Ebbw Vale',
                club: 'SE Wales',
                start: 67.5,
                end: 112.5,
                siteGuideUrl: 'https://www.flysouthwales.co.uk/site-guides/ebbw-vale/',
                pgRating: 'Pilot',
                hgRating: 'Pilot',
                membership: 'Open',
                level: 7,
            },
            {
                site: 'Bedlinog',
                club: 'SE Wales',
                start: 0,
                end: 359,
                siteGuideUrl: 'https://www.flysouthwales.co.uk/site-guides/bedlinog/',
                pgRating: 'CPM',
                hgRating: 'CPM',
                membership: 'Members',
                level: 1,
            }
        ];


        $('#membershipKey').show();
        $('#ratingKey').show();
        updateChart()

        $('#clubSelector').change(function () {
            updateChart()
        });

        $('document').ready(() => {
            var urlParams = new URLSearchParams(window.location.search);
            var club = urlParams.get('club');
            if (club != "" || club != 'N/A') {
                $('#clubSelector').val(club);
            }
            var view = urlParams.get('view').toLowerCase();
            if (view != "" || view != 'N/A') {
            
            }

            var membershipRating = true;

            updateChart();
        })

        updateChart();

        function updateChart() {
            var arcGenerator = d3.arc().cornerRadius(3);
            var membershipRating = true;
            
            var club = $('#clubSelector').val().toLowerCase();

            /////////////////////////////////////////////////////////
            //////////// Create the container SVG and g /////////////
            /////////////////////////////////////////////////////////

            //Remove whatever chart with the same id/class was present before
            d3.select('body').select("svg").remove();

            //Initiate the radar chart SVG
            var svg = d3.select('body').append("svg")
                .attr('width', width + margin + margin)
                .attr('height', height + margin + margin)
                .attr("class", "radar" + 'body');

            var g = svg.append("g")
                .attr("transform", "translate(" + (width / 2) + "," + (height / 2) + ")");

            /////////////////////////////////////////////////////////
            /////////////// Draw the Circular grid //////////////////
            /////////////////////////////////////////////////////////

            //Wrapper for the grid & axes
            var axisGrid = g.append("g").attr("class", "axisWrapper");

            //Draw the background circles
            axisGrid.selectAll(".levels")
                .data(d3.range(1, (levels + 1)).reverse())
                .enter()
                .append("circle")
                .attr("class", "gridCircle")
                .attr("r", function (d, i) { return chartRadius / levels * d; })
                .style("fill", "white")
                .style("stroke", "#CDCDCD")

            //Text indicating at what % each level is
            axisGrid.selectAll(".axisLabel")
                .data(d3.range(1, (levels + 1)).reverse())
                .enter().append("text")
                .attr("class", "axisLabel")
                .attr("x", 4)
                .attr("y", function (d) { return -d * chartRadius / levels; })
                .attr("dy", "0.4em")
                .style("font-size", "10px")
                .attr("fill", "#72bede")

            /////////////////////////////////////////////////////////
            //////////////////// Draw the axes //////////////////////
            /////////////////////////////////////////////////////////

            //Create the straight lines radiating outward from the center
            var axis = axisGrid.selectAll(".axis")
                .data(allAxis2)
                .enter()
                .append("g")
                .attr("class", "axis");
            //Append the lines
            axis.append("line")
                .attr("x1", 0)
                .attr("y1", 0)
                .attr("x2", function (d, i) { return rScale(maxValue * 1.1) * Math.cos(angleSlice * i - Math.PI / 2); })
                .attr("y2", function (d, i) { return rScale(maxValue * 1.1) * Math.sin(angleSlice * i - Math.PI / 2); })
                .attr("class", "line")
                .style("stroke", "black")
                .style("stroke-width", "1px");

            //Append the labels at each axis
            axis.append("text")
                .attr("class", "legend")
                .style("font-size", "14px")
                .attr("text-anchor", "middle")
                .attr("dy", "0.35em")
                .attr("x", function (d, i) { return rScale(maxValue * labelFactor) * Math.cos(angleSlice * i - Math.PI / 2); })
                .attr("y", function (d, i) { return rScale(maxValue * labelFactor) * Math.sin(angleSlice * i - Math.PI / 2); })
                .text(function (d) { return d })
                .call(wrap, wrapWidth);

            //Add new data
            for (var i = 0; i < data.length; i++) {
                if (data[i].club.toLowerCase() == club) {
                    var pathData = arcGenerator({
                        startAngle: data[i].start * (Math.PI / 180),
                        endAngle: data[i].end * (Math.PI / 180),
                        innerRadius: chartRadius / levels * (data[i].level - 1),
                        outerRadius: chartRadius / levels * (data[i].level),
                    });
                    var endAngle = data[i].end * (Math.PI / 180);
                    var firstArcSection = /(^.+?)L/;

                    //The [1] gives back the expression between the () (thus not the L as well)
                    //which is exactly the arc statement
                    var newArc = firstArcSection.exec(pathData)[1];
                    //Replace all the comma's so that IE can handle it -_-
                    //The g after the / is a modifier that "find all matches rather than
                    //stopping after the first match"
                    newArc = newArc.replace(/,/g, " ");

                    if (membershipRating) {
                        var pathData1 = arcGenerator({
                            startAngle: data[i].start * (Math.PI / 180),
                            endAngle: data[i].end * (Math.PI / 180),
                            innerRadius: chartRadius / levels * (data[i].level - 1),
                            outerRadius: chartRadius / levels * (data[i].level - 0.5),
                        });
                        var pathData2 = arcGenerator({
                            startAngle: data[i].start * (Math.PI / 180),
                            endAngle: data[i].end * (Math.PI / 180),
                            innerRadius: chartRadius / levels * (data[i].level - 0.5),
                            outerRadius: chartRadius / levels * (data[i].level),
                        });

                        let arc = g
                            .append('path')
                            .attr('d', pathData1)
                            .attr('class', 'arc')
                            .attr("id", data[i].site.trim())
                            .style('fill', membershipColors[data[i].membership]);

                        let arc2 = g
                            .append('path')
                            .attr('d', pathData2)
                            .attr('class', 'arc')
                            .attr("id", data[i].site.trim())
                            .style('fill', ratingColors[data[i].pgRating]);

                        g.append("path")
                            .attr("class", "hiddenDonutArcs")
                            .attr("id", data[i].site.trim() + "_textArc" + i)
                            .attr("d", newArc)
                            .style("fill", "none");

                        g.append('text')
                            .attr("x", 5) //Move the text from the start angle of the arc
                            //.attr("dy", 20) //Move the text down
                            .attr("dy", 18) //Move the text down
                            .append("textPath")
                            .attr("startOffset", "50%")
                            .style("text-anchor", "middle")
                            .attr("xlink:href", '#' + data[i].site.trim() + "_textArc" + i) //"#" + data[i].site.trim()
                            //.text(data[i].site.toUpperCase())
                            //style('font-weight', 'bold')
                            .text(data[i].site)
                            .style('font-weight', 'normal')
                            .style('stroke', 'black')
                            .style('font-size','18px')
                            //.style('stroke-width', '1px')
                            //.style('fill', 'white');
                            .style('fill', 'Black');

                        let arc3 = g
                            .append('path')
                            .attr('d', pathData)
                            .attr('class', 'arc')
                            .attr('text', data[i].siteGuideUrl)
                            .attr("id", data[i].site.trim() + "_box")
                            .style('fill-opacity', '0')
                            .style('stroke', 'black')
                            .style('stroke-width', '1.5px')
                            .on('click', function () {
                                window.open($(this).attr('text'), '_blank');
                            });


                    } 

                }

            };
        }
        /// ADDITIONAL SCRIPT


        function wrap(text, width) {
            text.each(function () {
                var text = d3.select(this),
                    words = text.text().split(/\s+/).reverse(),
                    word,
                    line = [],
                    lineNumber = 0,
                    lineHeight = 1.4, // ems
                    y = text.attr("y"),
                    x = text.attr("x"),
                    dy = parseFloat(text.attr("dy")),
                    tspan = text.text(null).append("tspan").attr("x", x).attr("y", y).attr("dy", dy + "em");

                while (word = words.pop()) {
                    line.push(word);
                    tspan.text(line.join(" "));
                    if (tspan.node().getComputedTextLength() > width) {
                        line.pop();
                        tspan.text(line.join(" "));
                        line = [word];
                        tspan = text.append("tspan").attr("x", x).attr("y", y).attr("dy", ++lineNumber * lineHeight + dy + "em").text(word);
                    }
                }
            });
        }//wrap	

    </script>
</body>

</html>